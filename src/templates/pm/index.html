{% extends "base/main-alt.html" %}
{# 
  Standard PM Page Template
  
  This template can be simplified by using pm-include templates:
  - See pm/index-refactored.html for the simplified version
  - See pm-include/README.md for usage documentation
#}

{% block title %}
  {# Priority: PM page metatags > Product metatags > PM title > Domain defaults #}
  {% if pm_metatags and pm_metatags.title %}
    {{ pm_metatags.title }}
  {% elif product_settings and product_settings.product.metatags and product_settings.product.metatags.title %}
    {{ product_settings.product.metatags.title }}
  {% elif pm and pm.title %}
    {{ pm.title }} - {{ DOMAIN_CONFIG['index_view_specific_metatags']['title'] }}
  {% else %}
    {{ DOMAIN_CONFIG['index_view_specific_metatags']['title'] }}
  {% endif %}
{% endblock title %}

{% block extra_head %}
  {# Include all PM head resources - simplified version available #}
  {# You can also use: {% include "pm-include/head-resources.html" %} #}
  <link rel="stylesheet" href="{{ request.url_for('static', path='core/css/pm.css') }}" />
  <link rel="stylesheet" href="{{ request.url_for('static', path='core/css/toc.css') }}" />
  <!-- MathLive for LaTeX (if needed later) -->
  <script src="https://cdn.jsdelivr.net/npm/mathlive@0.105.2/mathlive.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/mathlive@0.105.2/mathlive-static.min.css" rel="stylesheet" />
  <!-- CodeMirror (for codex_ rendering) -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
  <!-- Import map for JS namespace aliases -->
  <script type="importmap">
      {
          "imports": {
              "@js/": "{{ request.url_for('static', path='js/') }}"
          }
      }
  </script>

  {# Todo: Ensure stability cross domains  / producs #}

  {# Include PM metatags logic #}
  {% include 'pm/includes/metatags.html' %}

{% endblock extra_head %}

{% block content %}
  {# This entire block can be replaced with: {% include "pm-include/render-full.html" %} #}

  {% include "pm/includes/toc-sidebar.html" %}

  <div class="pm-container lg:text-lg w-full md:max-w-3xl lg:max-w-4xl xl:max-w-4xl mx-auto">
    <div class="bg-base-100 shadow-2xl mt-12 px-4 py-4">
      <!-- Main Content -->
      <div class="max-w-[640px] mx-auto md:py-12 bg-base-100">
        {# Include product warning message #}
        {% include "pm/includes/product-warning.html" %}

        <!-- Fragments (rendered via partials) -->
        {% include "pm/includes/fragments-renderer.html" %}
      </div>

      {# Include debug section when debug mode is enabled #}
      {% include "pm/includes/debug-section.html" %}

      {# Include PM runtime initialization #}
      {% include "pm/includes/runtime-init.html" %}
    </div>
  </div>
  <!-- djlint:on -->
{% endblock content %}
